<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>ìš´ë™ KPR ê´€ë¦¬ ì‹œìŠ¤í…œ</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * { margin:0; padding:0; box-sizing:border-box; }
        body { font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background:linear-gradient(135deg,#667eea 0%,#764ba2 100%); min-height:100vh; color:#333; }
        .container { max-width:1200px; margin:0 auto; padding:20px; }
        .header { text-align:center; margin-bottom:30px; color:#fff; }
        .header h1 { font-size:2.5rem; margin-bottom:10px; text-shadow:0 2px 4px rgba(0,0,0,0.3); }
        .header p { font-size:1.1rem; opacity:.9; }

        .nav-tabs { display:flex; background:#fff; border-radius:10px; margin-bottom:20px; box-shadow:0 4px 15px rgba(0,0,0,0.1); overflow:hidden; flex-wrap:wrap; }
        .nav-tab { flex:1; padding:15px 10px; text-align:center; cursor:pointer; background:#fff; border:none; font-size:.9rem; font-weight:600; transition:all .3s ease; min-width:100px; }
        .nav-tab:hover { background:#f8f9fa; }
        .nav-tab.active { background:linear-gradient(135deg,#667eea 0%,#764ba2 100%); color:#fff; }

        .content-area { background:#fff; border-radius:15px; padding:25px; box-shadow:0 8px 25px rgba(0,0,0,0.15); }

        .workout-sections { display:grid; grid-template-columns:repeat(auto-fit,minmax(300px,1fr)); gap:20px; margin-bottom:30px; }
        .workout-section { background:#f8f9fa; border-radius:12px; padding:20px; border-left:5px solid; }
        .workout-section.í•˜ì²´ { border-left-color:#e74c3c; }
        .workout-section.ë“± { border-left-color:#3498db; }
        .workout-section.ê°€ìŠ´ { border-left-color:#2ecc71; }
        .workout-section.ì–´ê¹¨ { border-left-color:#f39c12; }
        .workout-section.íŒ” { border-left-color:#9b59b6; }
        .workout-section.ì½”ì–´ { border-left-color:#1abc9c; }

        .section-title { font-size:1.3rem; font-weight:bold; margin-bottom:15px; display:flex; align-items:center; gap:8px; }

        .exercise-item { background:#fff; padding:12px 15px; margin-bottom:10px; border-radius:8px; box-shadow:0 2px 8px rgba(0,0,0,0.08); transition:transform .2s ease; }
        .exercise-item:hover { transform:translateY(-2px); box-shadow:0 4px 12px rgba(0,0,0,0.15); }
        .exercise-name { font-weight:600; margin-bottom:5px; color:#2c3e50; }
        .exercise-stats { display:flex; gap:15px; font-size:.9rem; color:#7f8c8d; flex-wrap:wrap; }
        .stat { display:flex; align-items:center; gap:4px; }

        .dashboard-stats { display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); gap:20px; margin-bottom:30px; }
        .stat-card { background:linear-gradient(135deg,#667eea 0%,#764ba2 100%); color:#fff; padding:20px; border-radius:12px; text-align:center; box-shadow:0 4px 15px rgba(0,0,0,0.1); }
        .stat-number { font-size:2rem; font-weight:bold; margin-bottom:5px; }
        .stat-label { font-size:.9rem; opacity:.9; }

        .chart-container { background:#fff; padding:20px; border-radius:12px; margin:20px 0; box-shadow:0 4px 15px rgba(0,0,0,0.1); }
        .chart-title { font-size:1.2rem; font-weight:600; margin-bottom:20px; text-align:center; color:#2c3e50; }

        .workout-form { background:#f8f9fa; padding:20px; border-radius:12px; margin-bottom:20px; }
        .form-group { margin-bottom:15px; }
        .form-label { display:block; margin-bottom:5px; font-weight:600; color:#2c3e50; }
        .form-input, .form-select { width:100%; padding:10px 12px; border:2px solid #e9ecef; border-radius:8px; font-size:1rem; transition:border-color .3s ease; }
        .form-input:focus, .form-select:focus { outline:none; border-color:#667eea; }
        .form-row { display:grid; grid-template-columns:repeat(auto-fit,minmax(120px,1fr)); gap:10px; }

        .btn { padding:10px 20px; border:none; border-radius:8px; cursor:pointer; font-weight:600; transition:all .3s ease; }
        .btn-primary { background:linear-gradient(135deg,#667eea 0%,#764ba2 100%); color:#fff; }
        .btn-secondary { background:#6c757d; color:#fff; }
        .btn-success { background:#28a745; color:#fff; }
        .btn-danger { background:#dc3545; color:#fff; }
        .btn:hover { transform:translateY(-2px); box-shadow:0 4px 12px rgba(0,0,0,0.2); }

        .timer-display { font-size:3rem; font-weight:bold; text-align:center; margin:20px 0; color:#2c3e50; }
        .timer-controls { display:flex; gap:10px; justify-content:center; margin-bottom:20px; }

        .volume-display { background:#e8f4fd; border:1px solid #bee5eb; border-radius:8px; padding:10px; margin:10px 0; text-align:center; font-weight:600; color:#0c5460; }

        .recent-workout { background:#f8f9fa; border-radius:8px; padding:15px; margin-bottom:10px; border-left:4px solid #667eea; }
        .workout-date { font-size:.9rem; color:#6c757d; margin-bottom:5px; }
        .workout-summary { display:flex; justify-content:space-between; align-items:center; }

        .progress-item { background:#fff; padding:15px; border-radius:8px; margin-bottom:10px; box-shadow:0 2px 8px rgba(0,0,0,0.08); }
        .progress-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:10px; }
        .progress-bar { width:100%; height:8px; background:#e9ecef; border-radius:4px; overflow:hidden; }
        .progress-fill { height:100%; background:linear-gradient(135deg,#667eea 0%,#764ba2 100%); transition:width .3s ease; }

        .add-exercise-btn { width:100%; padding:12px; background:linear-gradient(135deg,#667eea 0%,#764ba2 100%); color:#fff; border:none; border-radius:8px; cursor:pointer; font-weight:600; transition:all .3s ease; margin-top:10px; }
        .add-exercise-btn:hover { transform:translateY(-2px); box-shadow:0 4px 15px rgba(102,126,234,.4); }

        @media (max-width:768px) {
            .container { padding:10px; }
            .nav-tabs { flex-wrap:wrap; }
            .nav-tab { flex:none; min-width:80px; font-size:.8rem; padding:12px 8px; }
            .workout-sections { grid-template-columns:1fr; }
            .dashboard-stats { grid-template-columns:repeat(2,1fr); }
            .form-row { grid-template-columns:1fr; }
            .header h1 { font-size:2rem; }
        }
    </style>
</head>
<body>
<div id="root"></div>

<script type="text/babel" data-presets="env,react">
const { useState, useEffect, useRef } = React;

/* ì´ˆê¸° ìš´ë™ ë°ì´í„° */
const initialExercises = {
  'í•˜ì²´': [
    { name: 'ìŠ¤ì¿¼íŠ¸', weight: 70, reps: 10, sets: 3 },
    { name: 'ë ˆê·¸í”„ë ˆìŠ¤', weight: 115, reps: 15, sets: 3 },
    { name: 'ë ˆê·¸ìµìŠ¤í…ì…˜', weight: 50, reps: 12, sets: 3 },
    { name: 'ë ˆê·¸ì»¬', weight: 35, reps: 12, sets: 3 },
    { name: 'ìŠ¤í‹°í”„ë°ë“œ', weight: 14, reps: 12, sets: 3 }
  ],
  'ë“±': [
    { name: 'ë°”ë²¨ë¡œìš°', weight: 40, reps: 10, sets: 3 },
    { name: 'ë«í’€ë‹¤ìš´', weight: 40, reps: 12, sets: 3 },
    { name: 'íˆ¬ì•”ë¤ë²¨ë¡œìš°', weight: 14, reps: 12, sets: 3 },
    { name: 'ì›ì•”ë¤ë²¨ë¡œìš°', weight: 16, reps: 12, sets: 3 },
    { name: 'ì¼€ì´ë¸”ë¡œìš°', weight: 50, reps: 12, sets: 3 },
    { name: 'ì–´ì‹œìŠ¤íŠ¸í’€ì—…', weight: 90, reps: 12, sets: 3 }
  ],
  'ê°€ìŠ´': [
    { name: 'ë²¤ì¹˜í”„ë ˆìŠ¤', weight: 45, reps: 10, sets: 3 },
    { name: 'ë¤ë²¨ ë²¤ì¹˜í”„ë ˆìŠ¤', weight: 16, reps: 8, sets: 3 },
    { name: 'ì¸í´ë¼ì¸ë¤ë²¨í”„ë ˆìŠ¤', weight: 14, reps: 12, sets: 3 },
    { name: 'ì¸í´ë¼ì¸ìŠ¤ë¯¸ìŠ¤', weight: 30, reps: 10, sets: 3 },
    { name: 'ì¼€ì´ë¸” í¬ë¡œìŠ¤ì˜¤ë²„', weight: 20, reps: 12, sets: 3 },
    { name: 'í™ë± í”Œë¼ì´', weight: 25, reps: 12, sets: 3 }
  ],
  'ì–´ê¹¨': [
    { name: 'ì˜¤ë²„í—¤ë“œí”„ë ˆìŠ¤', weight: 25, reps: 11, sets: 3 },
    { name: 'í˜ì´ìŠ¤í’€', weight: 25, reps: 20, sets: 3 },
    { name: 'ì‚¬ì´ë“œ ë ˆí„°ëŸ´ ë ˆì´ì¦ˆ', weight: 5, reps: 12, sets: 3 },
    { name: 'ë²¤íŠ¸ ì˜¤ë²„ ë ˆì´ì¦ˆ', weight: 5, reps: 12, sets: 3 },
    { name: 'ë¦¬ì–´ ë¸íŠ¸ í”Œë¼ì´', weight: 15, reps: 12, sets: 3 }
  ],
  'íŒ”': [
    { name: 'ì¼€ì´ë¸”í‘¸ì‰¬ë‹¤ìš´', weight: 30, reps: 13, sets: 3 },
    { name: 'ë¤ë²¨ì»¬', weight: 8, reps: 10, sets: 3 }
  ],
  'ì½”ì–´': [
    { name: 'ë³µë¶€ì„œí‚·', weight: 0, reps: 30, sets: 3 }
  ]
};

/* ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ê´€ë¦¬ í›… */
const useLocalStorage = (key, initialValue) => {
  const [storedValue, setStoredValue] = useState(() => {
    try {
      const item = window.localStorage.getItem(key);
      return item ? JSON.parse(item) : initialValue;
    } catch (error) {
      console.error('Error reading from localStorage:', error);
      return initialValue;
    }
  });

  const setValue = (value) => {
    try {
      const valueToStore = typeof value === 'function' ? value(storedValue) : value;
      setStoredValue(valueToStore);
      window.localStorage.setItem(key, JSON.stringify(valueToStore));
    } catch (error) {
      console.error('Error writing to localStorage:', error);
    }
  };

  return [storedValue, setValue];
};

/* íƒ€ì´ë¨¸ ì»´í¬ë„ŒíŠ¸ */
const Timer = ({ isActive, time, onStart, onStop, onReset }) => {
  const formatTime = (seconds) => {
    const mins = Math.floor(seconds / 60);
    const secs = seconds % 60;
    return `${mins.toString().padStart(2,'0')}:${secs.toString().padStart(2,'0')}`;
  };

  return (
    <div className="chart-container">
      <div className="chart-title">íœ´ì‹ íƒ€ì´ë¨¸</div>
      <div className="timer-display">{formatTime(time)}</div>
      <div className="timer-controls">
        <button className={`btn ${isActive ? 'btn-danger' : 'btn-success'}`} onClick={isActive ? onStop : onStart}>
          {isActive ? 'ì •ì§€' : 'ì‹œì‘'}
        </button>
        <button className="btn btn-secondary" onClick={onReset}>ë¦¬ì…‹</button>
      </div>
    </div>
  );
};

/* ìš´ë™ ê¸°ë¡ í¼ ì»´í¬ë„ŒíŠ¸ */
const ExerciseForm = ({ bodyPart, exercises, onAddExercise }) => {
  const [selectedExercise, setSelectedExercise] = useState('');
  const [weight, setWeight] = useState('');
  const [reps, setReps] = useState('');
  const [sets, setSets] = useState('3');
  const [notes, setNotes] = useState('');

  const handleSubmit = (e) => {
    e.preventDefault();
    if (!selectedExercise || !weight || !reps) {
      alert('ìš´ë™, ë¬´ê²Œ, ë°˜ë³µìˆ˜ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');
      return;
    }
    const exerciseData = {
      id: Date.now(),
      name: selectedExercise,
      weight: parseFloat(weight),
      reps: parseInt(reps),
      sets: parseInt(sets),
      notes,
      date: new Date().toISOString(),
      bodyPart
    };
    onAddExercise(exerciseData);
    setWeight('');
    setReps('');
    setNotes('');
  };

  const calculateVolume = () => {
    const w = parseFloat(weight) || 0;
    const r = parseInt(reps) || 0;
    const s = parseInt(sets) || 0;
    return w * r * s;
  };

  return (
    <form className="workout-form" onSubmit={handleSubmit}>
      <div className="form-group">
        <label className="form-label">ìš´ë™ ì„ íƒ</label>
        <select
          className="form-select"
          value={selectedExercise}
          onChange={(e) => {
            setSelectedExercise(e.target.value);
            const exercise = exercises[bodyPart]?.find(ex => ex.name === e.target.value);
            if (exercise) {
              setWeight(exercise.weight.toString());
              setReps(exercise.reps.toString());
              setSets(exercise.sets.toString());
            }
          }}
        >
          <option value="">ìš´ë™ì„ ì„ íƒí•˜ì„¸ìš”</option>
          {exercises[bodyPart]?.map((exercise, idx) => (
            <option key={idx} value={exercise.name}>{exercise.name}</option>
          ))}
        </select>
      </div>

      <div className="form-row">
        <div className="form-group">
          <label className="form-label">ë¬´ê²Œ (kg)</label>
          <input type="number" className="form-input" value={weight} onChange={(e)=>setWeight(e.target.value)} step="0.5" min="0" />
        </div>
        <div className="form-group">
          <label className="form-label">ë°˜ë³µìˆ˜</label>
          <input type="number" className="form-input" value={reps} onChange={(e)=>setReps(e.target.value)} min="1" />
        </div>
        <div className="form-group">
          <label className="form-label">ì„¸íŠ¸ìˆ˜</label>
          <input type="number" className="form-input" value={sets} onChange={(e)=>setSets(e.target.value)} min="1" />
        </div>
      </div>

      <div className="form-group">
        <label className="form-label">ë©”ëª¨</label>
        <input type="text" className="form-input" value={notes} onChange={(e)=>setNotes(e.target.value)} placeholder="ìš´ë™ì— ëŒ€í•œ ë©”ëª¨ë¥¼ ì…ë ¥í•˜ì„¸ìš”" />
      </div>

      {weight && reps && sets && (
        <div className="volume-display">ì˜ˆìƒ ë³¼ë¥¨: {calculateVolume().toLocaleString()} kg</div>
      )}

      <button type="submit" className="btn btn-primary" style={{ width:'100%' }}>ìš´ë™ ê¸°ë¡ ì¶”ê°€</button>
    </form>
  );
};

/* ë¼ì´ë¸ŒëŸ¬ë¦¬ ì»´í¬ë„ŒíŠ¸ (í›… ì‚¬ìš© â†’ ë³„ë„ ì»´í¬ë„ŒíŠ¸ë¡œ ë¶„ë¦¬) */
function Library({ bodyParts, exercises, setExercises }) {
  const [searchTerm, setSearchTerm] = useState('');
  const [selectedBodyPart, setSelectedBodyPart] = useState('ì „ì²´');
  const [newExercise, setNewExercise] = useState({
    name: '', bodyPart: 'í•˜ì²´', weight: '', reps: '', sets: '3'
  });
  const [isAddingExercise, setIsAddingExercise] = useState(false);

  const addNewExercise = () => {
    if (!newExercise.name) return;
    const exerciseData = {
      name: newExercise.name,
      weight: parseFloat(newExercise.weight) || 0,
      reps: parseInt(newExercise.reps) || 12,
      sets: parseInt(newExercise.sets) || 3
    };
    setExercises(prev => ({
      ...prev,
      [newExercise.bodyPart]: [...(prev[newExercise.bodyPart] || []), exerciseData]
    }));
    setNewExercise({ name:'', bodyPart:'í•˜ì²´', weight:'', reps:'', sets:'3' });
    setIsAddingExercise(false);
  };

  const deleteExercise = (bodyPart, exerciseIndex) => {
    setExercises(prev => ({
      ...prev,
      [bodyPart]: prev[bodyPart].filter((_, idx) => idx !== exerciseIndex)
    }));
  };

  const filteredExercises = () => {
    const result = [];
    Object.entries(exercises).forEach(([part, list]) => {
      if (selectedBodyPart === 'ì „ì²´' || selectedBodyPart === part) {
        list.forEach((ex, idx) => {
          if (ex.name.toLowerCase().includes(searchTerm.toLowerCase())) {
            result.push({ ...ex, bodyPart: part, index: idx });
          }
        });
      }
    });
    return result;
  };

  return (
    <div>
      <div className="workout-form">
        <div className="form-group">
          <label className="form-label">ê²€ìƒ‰</label>
          <input type="text" className="form-input" placeholder="ìš´ë™ ì´ë¦„ìœ¼ë¡œ ê²€ìƒ‰..." value={searchTerm} onChange={(e)=>setSearchTerm(e.target.value)} />
        </div>

        <div className="form-group">
          <label className="form-label">ë¶€ìœ„ í•„í„°</label>
          <select className="form-select" value={selectedBodyPart} onChange={(e)=>setSelectedBodyPart(e.target.value)}>
            <option value="ì „ì²´">ì „ì²´</option>
            {bodyParts.map(part => <option key={part} value={part}>{part}</option>)}
          </select>
        </div>

        <button className="btn btn-primary" onClick={()=>setIsAddingExercise(!isAddingExercise)} style={{ width:'100%' }}>
          {isAddingExercise ? 'ì·¨ì†Œ' : 'ìƒˆ ìš´ë™ ì¶”ê°€'}
        </button>
      </div>

      {isAddingExercise && (
        <div className="workout-form">
          <div className="form-group">
            <label className="form-label">ìš´ë™ ì´ë¦„</label>
            <input type="text" className="form-input" value={newExercise.name} onChange={(e)=>setNewExercise(prev=>({...prev, name:e.target.value}))} placeholder="ìš´ë™ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”" />
          </div>

          <div className="form-row">
            <div className="form-group">
              <label className="form-label">ë¶€ìœ„</label>
              <select className="form-select" value={newExercise.bodyPart} onChange={(e)=>setNewExercise(prev=>({...prev, bodyPart:e.target.value}))}>
                {bodyParts.map(part => <option key={part} value={part}>{part}</option>)}
              </select>
            </div>
            <div className="form-group">
              <label className="form-label">ê¸°ë³¸ ë¬´ê²Œ</label>
              <input type="number" className="form-input" value={newExercise.weight} onChange={(e)=>setNewExercise(prev=>({...prev, weight:e.target.value}))} step="0.5" />
            </div>
            <div className="form-group">
              <label className="form-label">ê¸°ë³¸ ë°˜ë³µìˆ˜</label>
              <input type="number" className="form-input" value={newExercise.reps} onChange={(e)=>setNewExercise(prev=>({...prev, reps:e.target.value}))} />
            </div>
          </div>

          <button className="btn btn-success" onClick={addNewExercise} style={{ width:'100%' }}>ìš´ë™ ì¶”ê°€í•˜ê¸°</button>
        </div>
      )}

      <div className="chart-container">
        <div className="chart-title">ìš´ë™ ë¼ì´ë¸ŒëŸ¬ë¦¬ ({filteredExercises().length}ê°œ)</div>
        <div style={{ maxHeight:'400px', overflowY:'auto' }}>
          {filteredExercises().map((exercise, idx) => (
            <div key={idx} className="exercise-item">
              <div className="exercise-name">
                {exercise.name}
                <span style={{ background:'#e9ecef', color:'#6c757d', padding:'2px 8px', borderRadius:'12px', fontSize:'.8rem', marginLeft:'8px' }}>
                  {exercise.bodyPart}
                </span>
              </div>
              <div className="exercise-stats">
                <div className="stat">âš–ï¸ {exercise.weight}kg</div>
                <div className="stat">ğŸ”¢ {exercise.reps}íšŒ</div>
                <div className="stat">ğŸ“Š {exercise.sets}ì„¸íŠ¸</div>
                <button className="btn btn-danger" style={{ padding:'4px 8px', fontSize:'.8rem' }} onClick={()=>deleteExercise(exercise.bodyPart, exercise.index)}>ì‚­ì œ</button>
              </div>
            </div>
          ))}
        </div>
      </div>
    </div>
  );
}

/* ë©”ì¸ ì•± */
const WorkoutKPRApp = () => {
  const [activeTab, setActiveTab] = useState('dashboard');
  const [exercises, setExercises] = useLocalStorage('exercises', initialExercises);
  const [workoutHistory, setWorkoutHistory] = useLocalStorage('workoutHistory', []);
  const [personalRecords, setPersonalRecords] = useLocalStorage('personalRecords', {});
  const [timerTime, setTimerTime] = useState(0);
  const [isTimerActive, setIsTimerActive] = useState(false);
  const timerRef = useRef(null);

  const bodyParts = ['í•˜ì²´','ë“±','ê°€ìŠ´','ì–´ê¹¨','íŒ”','ì½”ì–´'];

  /* íƒ€ì´ë¨¸ */
  useEffect(()=>{
    if (isTimerActive) {
      timerRef.current = setInterval(()=>setTimerTime(prev=>prev+1), 1000);
    } else if (timerRef.current) {
      clearInterval(timerRef.current);
    }
    return ()=> { if (timerRef.current) clearInterval(timerRef.current); };
  }, [isTimerActive]);

  /* 1RM ê³„ì‚° (Epley) */
  const calculateOneRM = (weight, reps) => {
    if (reps === 1) return weight;
    return Math.round(weight * (1 + reps / 30));
  };

  /* ê¸°ë¡ ì¶”ê°€ */
  const addWorkoutRecord = (exerciseData) => {
    setWorkoutHistory(prev => [exerciseData, ...prev]);
    const exerciseName = exerciseData.name;
    const currentPR = personalRecords[exerciseName];
    const newOneRM = calculateOneRM(exerciseData.weight, exerciseData.reps);
    if (!currentPR || newOneRM > currentPR.oneRM) {
      setPersonalRecords(prev => ({
        ...prev,
        [exerciseName]: {
          weight: exerciseData.weight,
          reps: exerciseData.reps,
          oneRM: newOneRM,
          date: exerciseData.date
        }
      }));
    }
  };

  /* í†µê³„ */
  const calculateStats = () => {
    const today = new Date().toDateString();
    const thisWeek = new Date(Date.now() - 7*24*60*60*1000);
    const thisMonth = new Date(Date.now() - 30*24*60*60*1000);

    const todayWorkouts = workoutHistory.filter(w => new Date(w.date).toDateString() === today).length;
    const weekWorkouts = workoutHistory.filter(w => new Date(w.date) > thisWeek).length;
    const monthVolume = workoutHistory.filter(w => new Date(w.date) > thisMonth)
      .reduce((t,w)=>t + w.weight*w.reps*w.sets, 0);
    const totalPRs = Object.keys(personalRecords).length;

    return { todayWorkouts, weekWorkouts, monthVolume, totalPRs };
  };

  const stats = calculateStats();

  /* íƒ€ì´ë¨¸ ì»¨íŠ¸ë¡¤ */
  const startTimer = () => setIsTimerActive(true);
  const stopTimer = () => setIsTimerActive(false);
  const resetTimer = () => { setIsTimerActive(false); setTimerTime(0); };

  /* ì„¹ì…˜ ë Œë”ëŸ¬ (í›… ì‚¬ìš© ì—†ìŒ) */
  const renderDashboard = () => (
    <div>
      <div className="dashboard-stats">
        <div className="stat-card"><div className="stat-number">{stats.todayWorkouts}</div><div className="stat-label">ì˜¤ëŠ˜ ìš´ë™</div></div>
        <div className="stat-card"><div className="stat-number">{stats.weekWorkouts}</div><div className="stat-label">ì´ë²ˆ ì£¼ ìš´ë™</div></div>
        <div className="stat-card"><div className="stat-number">{(stats.monthVolume/1000).toFixed(1)}K</div><div className="stat-label">ì´ë²ˆ ë‹¬ ë³¼ë¥¨</div></div>
        <div className="stat-card"><div className="stat-number">{stats.totalPRs}</div><div className="stat-label">ê°œì¸ ê¸°ë¡</div></div>
      </div>

      <Timer isActive={isTimerActive} time={timerTime} onStart={startTimer} onStop={stopTimer} onReset={resetTimer} />

      <div className="chart-container">
        <div className="chart-title">ìµœê·¼ ìš´ë™ ê¸°ë¡</div>
        {workoutHistory.length === 0 ? (
          <div style={{ textAlign:'center', color:'#6c757d', padding:'20px' }}>ì•„ì§ ìš´ë™ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤. ìš´ë™ì„ ì‹œì‘í•´ë³´ì„¸ìš”!</div>
        ) : (
          workoutHistory.slice(0,5).map((workout, idx)=>(
            <div key={idx} className="recent-workout">
              <div className="workout-date">{new Date(workout.date).toLocaleDateString('ko-KR')}</div>
              <div className="workout-summary">
                <span><strong>{workout.name}</strong></span>
                <span>{workout.weight}kg Ã— {workout.reps} Ã— {workout.sets}ì„¸íŠ¸</span>
              </div>
            </div>
          ))
        )}
      </div>
    </div>
  );

  const renderWorkout = () => (
    <div>
      <ExerciseForm bodyPart="í•˜ì²´" exercises={exercises} onAddExercise={addWorkoutRecord} />
      <div className="workout-sections">
        {bodyParts.map(part => (
          <div key={part} className={`workout-section ${part}`}>
            <div className="section-title">ğŸ“ {part}</div>
            {exercises[part]?.map((exercise, idx)=>(
              <div key={idx} className="exercise-item">
                <div className="exercise-name">{exercise.name}</div>
                <div className="exercise-stats">
                  <div className="stat">âš–ï¸ {exercise.weight}kg</div>
                  <div className="stat">ğŸ”¢ {exercise.reps}íšŒ</div>
                  <div className="stat">ğŸ“Š {exercise.sets}ì„¸íŠ¸</div>
                  <div className="stat">ğŸ’ª {(exercise.weight*exercise.reps*exercise.sets).toLocaleString()}kg</div>
                </div>
              </div>
            ))}
          </div>
        ))}
      </div>
    </div>
  );

  const renderProgress = () => (
    <div>
      <div className="chart-container">
        <div className="chart-title">ê°œì¸ ê¸°ë¡ (PR)</div>
        {Object.keys(personalRecords).length === 0 ? (
          <div style={{ textAlign:'center', color:'#6c757d', padding:'20px' }}>ì•„ì§ ê°œì¸ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤. ìš´ë™ì„ ì‹œì‘í•´ë³´ì„¸ìš”!</div>
        ) : (
          Object.entries(personalRecords).map(([name, record])=>(
            <div key={name} className="progress-item">
              <div className="progress-header">
                <span><strong>{name}</strong></span>
                <span>{record.weight}kg Ã— {record.reps}íšŒ</span>
              </div>
              <div style={{ fontSize:'.9rem', color:'#6c757d' }}>
                1RM: {record.oneRM}kg | {new Date(record.date).toLocaleDateString('ko-KR')}
              </div>
            </div>
          ))
        )}
      </div>

      <div className="chart-container">
        <div className="chart-title">ë¶€ìœ„ë³„ ë³¼ë¥¨ ë¶„ì„</div>
        {bodyParts.map(part => {
          const vol = workoutHistory.filter(w=>w.bodyPart===part).reduce((t,w)=>t+w.weight*w.reps*w.sets,0);
          const maxVol = Math.max(...bodyParts.map(bp =>
            workoutHistory.filter(w=>w.bodyPart===bp).reduce((t,w)=>t+w.weight*w.reps*w.sets,0)
          ), 0);
          const pct = maxVol>0 ? (vol/maxVol)*100 : 0;
          return (
            <div key={part} className="progress-item">
              <div className="progress-header"><span>{part}</span><span>{vol.toLocaleString()}kg</span></div>
              <div className="progress-bar"><div className="progress-fill" style={{ width:`${pct}%` }}></div></div>
            </div>
          );
        })}
      </div>

      <div className="chart-container">
        <div className="chart-title">ìµœê·¼ ìš´ë™ íŠ¸ë Œë“œ</div>
        {workoutHistory.length === 0 ? (
          <div style={{ textAlign:'center', color:'#6c757d', padding:'20px' }}>ìš´ë™ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</div>
        ) : (
          workoutHistory.slice(0,10).map((w, idx)=>(
            <div key={idx} className="recent-workout">
              <div className="workout-date">
                {new Date(w.date).toLocaleDateString('ko-KR', { month:'short', day:'numeric', hour:'2-digit', minute:'2-digit' })}
              </div>
              <div className="workout-summary">
                <span><strong>{w.name}</strong><span style={{ color:'#6c757d', marginLeft:8 }}>({w.bodyPart})</span></span>
                <span>{w.weight}kg Ã— {w.reps} Ã— {w.sets}ì„¸íŠ¸
                  <span style={{ color:'#667eea', marginLeft:8 }}>= {(w.weight*w.reps*w.sets).toLocaleString()}kg</span>
                </span>
              </div>
              {w.notes && <div style={{ fontSize:'.9rem', color:'#6c757d', marginTop:5 }}>ğŸ“ {w.notes}</div>}
            </div>
          ))
        )}
      </div>
    </div>
  );

  const renderSettings = () => {
    const exportData = () => {
      const data = { exercises, workoutHistory, personalRecords, exportDate: new Date().toISOString() };
      const blob = new Blob([JSON.stringify(data,null,2)], { type:'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `workout-kpr-backup-${new Date().toISOString().split('T')[0]}.json`;
      a.click();
      URL.revokeObjectURL(url);
    };

    const importData = (event) => {
      const file = event.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = (e) => {
        try {
          const data = JSON.parse(e.target.result);
          if (data.exercises) setExercises(data.exercises);
          if (data.workoutHistory) setWorkoutHistory(data.workoutHistory);
          if (data.personalRecords) setPersonalRecords(data.personalRecords);
          alert('ë°ì´í„°ë¥¼ ì„±ê³µì ìœ¼ë¡œ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤!');
        } catch (err) {
          alert('íŒŒì¼ì„ ì½ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        }
      };
      reader.readAsText(file);
    };

    return (
      <div>
        <div className="chart-container">
          <div className="chart-title">ë°ì´í„° ê´€ë¦¬</div>
          <div style={{ display:'flex', gap:10, marginBottom:20, flexWrap:'wrap' }}>
            <button className="btn btn-primary" onClick={exportData}>ë°ì´í„° ë‚´ë³´ë‚´ê¸°</button>
            <label className="btn btn-secondary" style={{ margin:0, cursor:'pointer' }}>
              ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
              <input type="file" accept=".json" onChange={importData} style={{ display:'none' }} />
            </label>
          </div>

          <div style={{ background:'#f8f9fa', padding:15, borderRadius:8 }}>
            <h4>í†µê³„ ìš”ì•½</h4>
            <p>ì´ ìš´ë™ ê¸°ë¡: {workoutHistory.length}ê°œ</p>
            <p>ê°œì¸ ê¸°ë¡: {Object.keys(personalRecords).length}ê°œ</p>
            <p>ë“±ë¡ëœ ìš´ë™: {Object.values(exercises).flat().length}ê°œ</p>
            <p>ì´ ë³¼ë¥¨: {workoutHistory.reduce((t,w)=>t+w.weight*w.reps*w.sets,0).toLocaleString()}kg</p>
          </div>
        </div>

        <div className="chart-container">
          <div className="chart-title">ì•± ì •ë³´</div>
          <div style={{ background:'#f8f9fa', padding:15, borderRadius:8 }}>
            <h4>ìš´ë™ KPR ê´€ë¦¬ ì‹œìŠ¤í…œ</h4>
            <p>ë²„ì „: 1.0.0</p>
            <p>ê°œë°œì: Workout KPR Team</p>
            <p>ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: 2025ë…„ 8ì›”</p>
            <br />
            <h5>ì£¼ìš” ê¸°ëŠ¥</h5>
            <ul style={{ paddingLeft:20 }}>
              <li>ìš´ë™ ê¸°ë¡ ê´€ë¦¬</li>
              <li>ê°œì¸ ê¸°ë¡(PR) ì¶”ì </li>
              <li>ë³¼ë¥¨ ë° ì§„ë„ ë¶„ì„</li>
              <li>íœ´ì‹ íƒ€ì´ë¨¸</li>
              <li>ë°ì´í„° ë°±ì—…/ë³µì›</li>
            </ul>
          </div>
        </div>
      </div>
    );
  };

  return (
    <div className="container">
      <div className="header">
        <h1>ğŸ’ª ìš´ë™ KPR ê´€ë¦¬ ì‹œìŠ¤í…œ</h1>
        <p>ì²´ê³„ì ì¸ ìš´ë™ ê¸°ë¡ìœ¼ë¡œ ë” ë‚˜ì€ í¼í¬ë¨¼ìŠ¤ë¥¼ ë§Œë“¤ì–´ë³´ì„¸ìš”</p>
      </div>

      <div className="nav-tabs">
        <button className={`nav-tab ${activeTab==='dashboard' ? 'active' : ''}`} onClick={()=>setActiveTab('dashboard')}>ğŸ“Š ëŒ€ì‹œë³´ë“œ</button>
        <button className={`nav-tab ${activeTab==='workout' ? 'active' : ''}`} onClick={()=>setActiveTab('workout')}>ğŸ‹ï¸ ìš´ë™ê¸°ë¡</button>
        <button className={`nav-tab ${activeTab==='progress' ? 'active' : ''}`} onClick={()=>setActiveTab('progress')}>ğŸ“ˆ ì§„ë„ì¶”ì </button>
        <button className={`nav-tab ${activeTab==='library' ? 'active' : ''}`} onClick={()=>setActiveTab('library')}>ğŸ“š ë¼ì´ë¸ŒëŸ¬ë¦¬</button>
        <button className={`nav-tab ${activeTab==='settings' ? 'active' : ''}`} onClick={()=>setActiveTab('settings')}>âš™ï¸ ì„¤ì •</button>
      </div>

      <div className="content-area">
        {activeTab==='dashboard' && renderDashboard()}
        {activeTab==='workout' && renderWorkout()}
        {activeTab==='progress' && renderProgress()}
        {activeTab==='library' && <Library bodyParts={bodyParts} exercises={exercises} setExercises={setExercises} />}
        {activeTab==='settings' && renderSettings()}
      </div>
    </div>
  );
};

/* React 18 ë§ˆìš´íŠ¸ */
const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(<WorkoutKPRApp />);
</script>
</body>
</html>
